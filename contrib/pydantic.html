

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../_static/tortoise.png">
    
    
      
        <title>Pydantic 序列化 - Tortoise ORM v0.21.7 Documentation</title>
      
    
    
      
        
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.4b4a8c74e2ff2ab5b.min.css?v=afa97f93" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#id1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../toc.html" title="Tortoise ORM v0.21.7 Documentation" class="md-header__button md-logo" aria-label="Tortoise ORM v0.21.7 Documentation" data-md-component="logo">
      <img src="../_static/tortoise.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tortoise ORM 0.21.7 Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pydantic 序列化
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/tortoise-orm-zh-cn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    tortoise-orm-zh-cn
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../index.html" class="md-tabs__link">
      <span class="md-ellipsis">Tortoise ORM</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../getting_started.html" class="md-tabs__link">
      <span class="md-ellipsis">开始入门</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../reference.html" class="md-tabs__link">
      <span class="md-ellipsis">参考</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../examples.html" class="md-tabs__link">
      <span class="md-ellipsis">样例</span>
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="../contrib.html" class="md-tabs__link md-tabs__link--active">
      <span class="md-ellipsis">集成/插件</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../CHANGELOG.html" class="md-tabs__link">
      <span class="md-ellipsis">变更日志</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../roadmap.html" class="md-tabs__link">
      <span class="md-ellipsis">路线图</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../CONTRIBUTING.html" class="md-tabs__link">
      <span class="md-ellipsis">贡献指南</span>
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../CONTRIBUTORS.html" class="md-tabs__link">
      <span class="md-ellipsis">感谢</span>
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../toc.html" title="Tortoise ORM v0.21.7 Documentation" class="md-nav__button md-logo" aria-label="Tortoise ORM v0.21.7 Documentation" data-md-component="logo">
      <img src="../_static/tortoise.png" alt="logo">
    </a>
    Tortoise ORM v0.21.7 Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/tortoise-orm-zh-cn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    tortoise-orm-zh-cn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise ORM</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started.html" class="md-nav__link">
        <span class="md-ellipsis">开始入门</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../reference.html"><span class="md-ellipsis">参考</span></a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="参考" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">参考</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup.html" class="md-nav__link">
        <span class="md-ellipsis">启动</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../databases.html" class="md-nav__link">
        <span class="md-ellipsis">数据库</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../models.html" class="md-nav__link">
        <span class="md-ellipsis">模型</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields.html" class="md-nav__link">
        <span class="md-ellipsis">字段</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../indexes.html" class="md-nav__link">
        <span class="md-ellipsis">索引</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../timezone.html" class="md-nav__link">
        <span class="md-ellipsis">时区</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema.html" class="md-nav__link">
        <span class="md-ellipsis">Schema 创建</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../query.html" class="md-nav__link">
        <span class="md-ellipsis">查询API</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../manager.html" class="md-nav__link">
        <span class="md-ellipsis">Manager</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions.html" class="md-nav__link">
        <span class="md-ellipsis">函数和聚合</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../expressions.html" class="md-nav__link">
        <span class="md-ellipsis">表达式</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../transactions.html" class="md-nav__link">
        <span class="md-ellipsis">事务</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../connections.html" class="md-nav__link">
        <span class="md-ellipsis">连接</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions.html" class="md-nav__link">
        <span class="md-ellipsis">异常</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../signals.html" class="md-nav__link">
        <span class="md-ellipsis">信号</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration.html" class="md-nav__link">
        <span class="md-ellipsis">迁移</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../validators.html" class="md-nav__link">
        <span class="md-ellipsis">校验</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging.html" class="md-nav__link">
        <span class="md-ellipsis">Logging</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../router.html" class="md-nav__link">
        <span class="md-ellipsis">路由</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise<wbr>CLI</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples.html"><span class="md-ellipsis">样例</span></a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="样例" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">样例</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/basic.html" class="md-nav__link">
        <span class="md-ellipsis">简单样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/pydantic.html" class="md-nav__link">
        <span class="md-ellipsis">Pydantic 样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/fastapi.html" class="md-nav__link">
        <span class="md-ellipsis">Fast<wbr>API 样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/quart.html" class="md-nav__link">
        <span class="md-ellipsis">Quart 样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/sanic.html" class="md-nav__link">
        <span class="md-ellipsis">Sanic 样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/starlette.html" class="md-nav__link">
        <span class="md-ellipsis">Starlette 样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/aiohttp.html" class="md-nav__link">
        <span class="md-ellipsis">AIOHTTP 样例</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/blacksheep.html" class="md-nav__link">
        <span class="md-ellipsis">Black<wbr>Sheep 样例</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../contrib.html"><span class="md-ellipsis">集成/插件</span></a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="集成/插件" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">集成/插件</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="linters.html" class="md-nav__link">
        <span class="md-ellipsis">Linters</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span class="md-ellipsis">Pydantic 序列化</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span class="md-ellipsis">Pydantic 序列化</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span class="md-ellipsis">Pydantic 序列化</span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#id1" class="md-nav__link">
    <span class="md-ellipsis">教程</span>
  </a>
  
    <nav class="md-nav" aria-label="教程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id2" class="md-nav__link">
    <span class="md-ellipsis">1:<wbr> 基本用法</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querysetlist" class="md-nav__link">
    <span class="md-ellipsis">2:<wbr> Queryset和List</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id6" class="md-nav__link">
    <span class="md-ellipsis">3:<wbr> 关系和初始化</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydanticmeta-callables" class="md-nav__link">
    <span class="md-ellipsis">4:<wbr> Pydantic<wbr>Meta 和 Callables</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#id7" class="md-nav__link">
    <span class="md-ellipsis">创建器</span>
  </a>
  
    <nav class="md-nav" aria-label="创建器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_model_creator" class="md-nav__link">
    <span aria-label="Python function" class="objinfo-icon objinfo-icon__procedure" title="Python function">F</span><span title="tortoise.contrib.pydantic.creator.pydantic_model_creator (Python function) — Function to build Pydantic Model off Tortoise Model." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>creator.<wbr>pydantic_<wbr>model_<wbr>creator</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.creator.pydantic_model_creator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_model_creator-parameters" class="md-nav__link">
    <span class="md-ellipsis">Parameters</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_model_creator-return-type" class="md-nav__link">
    <span class="md-ellipsis">Return type</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator" class="md-nav__link">
    <span aria-label="Python function" class="objinfo-icon objinfo-icon__procedure" title="Python function">F</span><span title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator (Python function) — Function to build a Pydantic Model list off Tortoise Model." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>creator.<wbr>pydantic_<wbr>queryset_<wbr>creator</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.creator.pydantic_queryset_creator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator-parameters" class="md-nav__link">
    <span class="md-ellipsis">Parameters</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator-return-type" class="md-nav__link">
    <span class="md-ellipsis">Return type</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydanticmeta" class="md-nav__link">
    <span class="md-ellipsis">Pydantic<wbr>Meta</span>
  </a>
  
    <nav class="md-nav" aria-label="PydanticMeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta" class="md-nav__link">
    <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta (Python class) — The PydanticMeta class is used to configure metadata for generating the pydantic Model." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>creator.<wbr>Pydantic<wbr>Meta</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.creator.PydanticMeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.allow_cycles" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.allow_cycles (Python attribute) — Allow cycles in recursion - This can result in HUGE data - Be careful! Please use this with exclude/include and sane max_recursion" class="md-ellipsis">allow_<wbr>cycles</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.backward_relations" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.backward_relations (Python attribute) — Use backward relations without annotations - not recommended, it can be huge data without control" class="md-ellipsis">backward_<wbr>relations</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.computed" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.computed (Python attribute) — Computed fields can be listed here to use in pydantic model" class="md-ellipsis">computed</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.exclude" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.exclude (Python attribute) — Fields listed in this property will be excluded from pydantic model" class="md-ellipsis">exclude</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.exclude_raw_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.exclude_raw_fields (Python attribute) — If we should exclude raw fields (the ones have _id suffixes) of relations" class="md-ellipsis">exclude_<wbr>raw_<wbr>fields</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.include" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.include (Python attribute) — If not empty, only fields this property contains will be in the pydantic model" class="md-ellipsis">include</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.max_recursion" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.max_recursion (Python attribute) — Maximum recursion level allowed" class="md-ellipsis">max_<wbr>recursion</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.model_config" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.model_config (Python attribute) — Allows user to specify custom config for generated model" class="md-ellipsis">model_<wbr>config</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.sort_alphabetically" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.sort_alphabetically (Python attribute) — Sort fields alphabetically. If not set (or False) then leave fields in declaration order" class="md-ellipsis">sort_<wbr>alphabetically</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#id8" class="md-nav__link">
    <span class="md-ellipsis">模型类</span>
  </a>
  
    <nav class="md-nav" aria-label="模型类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel" class="md-nav__link">
    <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tortoise.contrib.pydantic.base.PydanticListModel (Python class) — Pydantic BaseModel for List of Tortoise Models" class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>base.<wbr>Pydantic<wbr>List<wbr>Model</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.base.PydanticListModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset (Python method) — Returns a serializable pydantic model instance that contains a list of models, from the provided queryset." class="md-ellipsis">from_<wbr>queryset</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.model_computed_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.model_computed_fields (Python attribute) — A dictionary of computed field names and their corresponding ComputedFieldInfo objects." class="md-ellipsis">model_<wbr>computed_<wbr>fields</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.model_config" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.model_config (Python attribute) — Configuration for the model, should be a dictionary conforming to [ConfigDict][pydantic.config.ConfigDict]." class="md-ellipsis">model_<wbr>config</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.model_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.model_fields (Python attribute) — Metadata about the fields defined on the model, mapping of field names to [FieldInfo][pydantic.fields.FieldInfo] objects." class="md-ellipsis">model_<wbr>fields</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel" class="md-nav__link">
    <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tortoise.contrib.pydantic.base.PydanticModel (Python class) — Pydantic BaseModel for Tortoise objects." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>base.<wbr>Pydantic<wbr>Model</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.base.PydanticModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticModel.from_queryset (Python method) — Returns a serializable pydantic model instance that contains a list of models, from the provided queryset." class="md-ellipsis">from_<wbr>queryset</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single (Python method) — Returns a serializable pydantic model instance for a single model from the provided queryset." class="md-ellipsis">from_<wbr>queryset_<wbr>single</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm (Python method) — Returns a serializable pydantic model instance built from the provided model instance." class="md-ellipsis">from_<wbr>tortoise_<wbr>orm</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.model_computed_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticModel.model_computed_fields (Python attribute) — A dictionary of computed field names and their corresponding ComputedFieldInfo objects." class="md-ellipsis">model_<wbr>computed_<wbr>fields</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.model_config" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticModel.model_config (Python attribute) — Configuration for the model, should be a dictionary conforming to [ConfigDict][pydantic.config.ConfigDict]." class="md-ellipsis">model_<wbr>config</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.model_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticModel.model_fields (Python attribute) — Metadata about the fields defined on the model, mapping of field names to [FieldInfo][pydantic.fields.FieldInfo] objects." class="md-ellipsis">model_<wbr>fields</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="unittest.html" class="md-nav__link">
        <span class="md-ellipsis">单元测试支持</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="fastapi.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise-<wbr>ORM Fast<wbr>API 集成</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="quart.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise-<wbr>ORM Quart 集成</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="sanic.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise-<wbr>ORM Sanic 集成</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="starlette.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise-<wbr>ORM Starlette 集成</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="aiohttp.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise-<wbr>ORM aiohttp 集成</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="mysql.html" class="md-nav__link">
        <span class="md-ellipsis">My<wbr>SQL</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="postgres.html" class="md-nav__link">
        <span class="md-ellipsis">Postgres</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="blacksheep.html" class="md-nav__link">
        <span class="md-ellipsis">Tortoise-<wbr>ORM Black<wbr>Sheep 集成</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG.html" class="md-nav__link">
        <span class="md-ellipsis">变更日志</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap.html" class="md-nav__link">
        <span class="md-ellipsis">路线图</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../CONTRIBUTING.html"><span class="md-ellipsis">贡献指南</span></a>
          
            <label for="__nav_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="贡献指南" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">贡献指南</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../CODE_OF_CONDUCT.html" class="md-nav__link">
        <span class="md-ellipsis">Contributor Covenant Code of Conduct</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTORS.html" class="md-nav__link">
        <span class="md-ellipsis">感谢</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span class="md-ellipsis">Pydantic 序列化</span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#id1" class="md-nav__link">
    <span class="md-ellipsis">教程</span>
  </a>
  
    <nav class="md-nav" aria-label="教程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id2" class="md-nav__link">
    <span class="md-ellipsis">1:<wbr> 基本用法</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querysetlist" class="md-nav__link">
    <span class="md-ellipsis">2:<wbr> Queryset和List</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id6" class="md-nav__link">
    <span class="md-ellipsis">3:<wbr> 关系和初始化</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydanticmeta-callables" class="md-nav__link">
    <span class="md-ellipsis">4:<wbr> Pydantic<wbr>Meta 和 Callables</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#id7" class="md-nav__link">
    <span class="md-ellipsis">创建器</span>
  </a>
  
    <nav class="md-nav" aria-label="创建器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_model_creator" class="md-nav__link">
    <span aria-label="Python function" class="objinfo-icon objinfo-icon__procedure" title="Python function">F</span><span title="tortoise.contrib.pydantic.creator.pydantic_model_creator (Python function) — Function to build Pydantic Model off Tortoise Model." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>creator.<wbr>pydantic_<wbr>model_<wbr>creator</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.creator.pydantic_model_creator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_model_creator-parameters" class="md-nav__link">
    <span class="md-ellipsis">Parameters</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_model_creator-return-type" class="md-nav__link">
    <span class="md-ellipsis">Return type</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator" class="md-nav__link">
    <span aria-label="Python function" class="objinfo-icon objinfo-icon__procedure" title="Python function">F</span><span title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator (Python function) — Function to build a Pydantic Model list off Tortoise Model." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>creator.<wbr>pydantic_<wbr>queryset_<wbr>creator</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.creator.pydantic_queryset_creator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator-parameters" class="md-nav__link">
    <span class="md-ellipsis">Parameters</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator-return-type" class="md-nav__link">
    <span class="md-ellipsis">Return type</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydanticmeta" class="md-nav__link">
    <span class="md-ellipsis">Pydantic<wbr>Meta</span>
  </a>
  
    <nav class="md-nav" aria-label="PydanticMeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta" class="md-nav__link">
    <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta (Python class) — The PydanticMeta class is used to configure metadata for generating the pydantic Model." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>creator.<wbr>Pydantic<wbr>Meta</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.creator.PydanticMeta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.allow_cycles" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.allow_cycles (Python attribute) — Allow cycles in recursion - This can result in HUGE data - Be careful! Please use this with exclude/include and sane max_recursion" class="md-ellipsis">allow_<wbr>cycles</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.backward_relations" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.backward_relations (Python attribute) — Use backward relations without annotations - not recommended, it can be huge data without control" class="md-ellipsis">backward_<wbr>relations</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.computed" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.computed (Python attribute) — Computed fields can be listed here to use in pydantic model" class="md-ellipsis">computed</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.exclude" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.exclude (Python attribute) — Fields listed in this property will be excluded from pydantic model" class="md-ellipsis">exclude</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.exclude_raw_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.exclude_raw_fields (Python attribute) — If we should exclude raw fields (the ones have _id suffixes) of relations" class="md-ellipsis">exclude_<wbr>raw_<wbr>fields</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.include" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.include (Python attribute) — If not empty, only fields this property contains will be in the pydantic model" class="md-ellipsis">include</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.max_recursion" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.max_recursion (Python attribute) — Maximum recursion level allowed" class="md-ellipsis">max_<wbr>recursion</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.model_config" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.model_config (Python attribute) — Allows user to specify custom config for generated model" class="md-ellipsis">model_<wbr>config</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.creator.PydanticMeta.sort_alphabetically" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.creator.PydanticMeta.sort_alphabetically (Python attribute) — Sort fields alphabetically. If not set (or False) then leave fields in declaration order" class="md-ellipsis">sort_<wbr>alphabetically</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#id8" class="md-nav__link">
    <span class="md-ellipsis">模型类</span>
  </a>
  
    <nav class="md-nav" aria-label="模型类">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel" class="md-nav__link">
    <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tortoise.contrib.pydantic.base.PydanticListModel (Python class) — Pydantic BaseModel for List of Tortoise Models" class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>base.<wbr>Pydantic<wbr>List<wbr>Model</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.base.PydanticListModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset (Python method) — Returns a serializable pydantic model instance that contains a list of models, from the provided queryset." class="md-ellipsis">from_<wbr>queryset</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.model_computed_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.model_computed_fields (Python attribute) — A dictionary of computed field names and their corresponding ComputedFieldInfo objects." class="md-ellipsis">model_<wbr>computed_<wbr>fields</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.model_config" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.model_config (Python attribute) — Configuration for the model, should be a dictionary conforming to [ConfigDict][pydantic.config.ConfigDict]." class="md-ellipsis">model_<wbr>config</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticListModel.model_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticListModel.model_fields (Python attribute) — Metadata about the fields defined on the model, mapping of field names to [FieldInfo][pydantic.fields.FieldInfo] objects." class="md-ellipsis">model_<wbr>fields</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel" class="md-nav__link">
    <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span><span title="tortoise.contrib.pydantic.base.PydanticModel (Python class) — Pydantic BaseModel for Tortoise objects." class="md-ellipsis">tortoise.<wbr>contrib.<wbr>pydantic.<wbr>base.<wbr>Pydantic<wbr>Model</span>
  </a>
  
    <nav class="md-nav" aria-label="tortoise.contrib.pydantic.base.PydanticModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticModel.from_queryset (Python method) — Returns a serializable pydantic model instance that contains a list of models, from the provided queryset." class="md-ellipsis">from_<wbr>queryset</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single (Python method) — Returns a serializable pydantic model instance for a single model from the provided queryset." class="md-ellipsis">from_<wbr>queryset_<wbr>single</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm" class="md-nav__link">
    <span aria-label="Python method" class="objinfo-icon objinfo-icon__procedure" title="Python method">M</span><span title="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm (Python method) — Returns a serializable pydantic model instance built from the provided model instance." class="md-ellipsis">from_<wbr>tortoise_<wbr>orm</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.model_computed_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticModel.model_computed_fields (Python attribute) — A dictionary of computed field names and their corresponding ComputedFieldInfo objects." class="md-ellipsis">model_<wbr>computed_<wbr>fields</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.model_config" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticModel.model_config (Python attribute) — Configuration for the model, should be a dictionary conforming to [ConfigDict][pydantic.config.ConfigDict]." class="md-ellipsis">model_<wbr>config</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tortoise.contrib.pydantic.base.PydanticModel.model_fields" class="md-nav__link">
    <span aria-label="Python attribute" class="objinfo-icon objinfo-icon__alias" title="Python attribute">A</span><span title="tortoise.contrib.pydantic.base.PydanticModel.model_fields (Python attribute) — Metadata about the fields defined on the model, mapping of field names to [FieldInfo][pydantic.fields.FieldInfo] objects." class="md-ellipsis">model_<wbr>fields</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


  <a href="https://github.com/hellowac/tortoise-orm-zh-cn/blob/main/docs/contrib/pydantic.rst" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>

<h1 id="pydantic"><span id="contrib-pydantic"></span>Pydantic 序列化<a class="headerlink" href="#pydantic" title="Link to this heading">¶</a></h1>
<p><strong>Pydantic serialisation</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2">
<input checked type="radio" id="__tabbed_1_1" name="__tabbed_1"><input type="radio" id="__tabbed_1_2" name="__tabbed_1"><div class="tabbed-labels docutils container">
<label class="tabbed-label" for="__tabbed_1_1">
中文</label><label class="tabbed-label" for="__tabbed_1_2">
英文</label></div>
<div class="tabbed-content docutils container">
<div class="tabbed-block docutils container">
<p>Tortoise ORM 具有一个 Pydantic 插件，可以从 Tortoise 模型生成 Pydantic 模型，并提供辅助函数来序列化该模型及其相关对象。</p>
<p>目前我们只支持为序列化生成 Pydantic 对象，尚不支持反序列化。</p>
<p>请参阅 <a class="reference internal" href="../examples/pydantic.html#examples-pydantic"><span class="std std-ref">Pydantic 样例</span></a>。</p>
</div>
<div class="tabbed-block docutils container">
<p>Tortoise ORM has a Pydantic plugin that will generate Pydantic Models from Tortoise Models, and then provides helper functions to serialise that model and its related objects.</p>
<p>We currently only support generating Pydantic objects for serialisation, and no deserialisation at this stage.</p>
<p>See the <a class="reference internal" href="../examples/pydantic.html#examples-pydantic"><span class="std std-ref">Pydantic 样例</span></a></p>
</div>
</div>
</div><h2 id="id1">教程<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p><strong>Tutorial</strong></p>
<h3 id="id2">1: 基本用法<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p><strong>Basic usage</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2">
<input checked type="radio" id="__tabbed_2_1" name="__tabbed_2"><input type="radio" id="__tabbed_2_2" name="__tabbed_2"><div class="tabbed-labels docutils container">
<label class="tabbed-label" for="__tabbed_2_1">
中文</label><label class="tabbed-label" for="__tabbed_2_2">
英文</label></div>
<div class="tabbed-content docutils container">
<div class="tabbed-block docutils container">
<p>在这里，我们介绍：</p>
<ul class="simple">
<li><p>从 Tortoise 模型创建 Pydantic 模型</p></li>
<li><p>使用文档字符串和文档注释</p></li>
<li><p>评估生成的架构</p></li>
<li><p>使用 <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code> 进行简单序列化</p></li>
</ul>
<p>示例源代码： <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut1"><span class="std std-ref">1: 基本用法</span></a></p>
<p>让我们从一个基本的 Tortoise 模型开始：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">tortoise.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这是一个比赛的引用</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#: 比赛记录创建的日期时间</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="line-block">
<div class="line">要从中创建 Pydantic 模型，可以调用：</div>
<div class="line"><a class="reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator" title="tortoise.contrib.pydantic.creator.pydantic_model_creator (Python function) — Function to build Pydantic Model off Tortoise Model."><code class="xref py py-meth docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.pydantic_model_creator()</span></code></a></div>
</div>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise.contrib.pydantic</span> <span class="kn">import</span> <span class="n">pydantic_model_creator</span>

<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>现在我们有了一个 <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic 模型</a>，可以用于表示架构和序列化。</p>
<p><code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> 的 JSON 架构现在是：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;这是一个比赛的引用&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">    &#39;properties&#39;: {</span>
<span class="go">        &#39;id&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;name&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;created_at&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;比赛记录创建的日期时间&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">            &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>注意类文档字符串和文档注释 <code class="docutils literal notranslate"><span class="pre">#:</span></code> 被包含为架构中的描述。</p>
<p>要序列化一个对象，仅需 <em>(在异步上下文中)</em>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">tournament</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;新比赛&quot;</span><span class="p">)</span>
<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>可以使用 <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/exporting_models/">常规 Pydantic 对象方法</a> 获取内容，例如 <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code>。</p>
</div>
<div class="tabbed-block docutils container">
<p>Here we introduce:</p>
<ul class="simple">
<li><p>Creating a Pydantic model from a Tortoise model</p></li>
<li><p>Docstrings &amp; doc-comments are used</p></li>
<li><p>Evaluating the generated schema</p></li>
<li><p>Simple serialisation with both <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> and <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code></p></li>
</ul>
<p>Source to example: <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut1"><span class="std std-ref">1: 基本用法</span></a></p>
<p>Lets start with a basic Tortoise Model:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">tortoise.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This references a Tournament</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#: The date-time the Tournament record was created at</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="line-block">
<div class="line">To create a Pydantic model from that one would call:</div>
<div class="line"><a class="reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator" title="tortoise.contrib.pydantic.creator.pydantic_model_creator (Python function) — Function to build Pydantic Model off Tortoise Model."><code class="xref py py-meth docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.pydantic_model_creator()</span></code></a></div>
</div>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise.contrib.pydantic</span> <span class="kn">import</span> <span class="n">pydantic_model_creator</span>

<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>And now have a <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic Model</a> that can be used for representing schema and serialisation.</p>
<p>The JSON-Schema of <code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> is now:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;This references a Tournament&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">    &#39;properties&#39;: {</span>
<span class="go">        &#39;id&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;name&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;created_at&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;The date-time the Tournament record was created at&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">            &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>Note how the class docstring and doc-comment <code class="docutils literal notranslate"><span class="pre">#:</span></code> is included as descriptions in the Schema.</p>
<p>To serialise an object it is simply <em>(in an async context)</em>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">tournament</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;New Tournament&quot;</span><span class="p">)</span>
<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>And one could get the contents by using <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/exporting_models/">regular Pydantic-object methods</a>, such as <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> or <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code></p>
</div>
</div>
</div><div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;id&#39;: 1,</span>
<span class="go">    &#39;name&#39;: &#39;New Tournament&#39;,</span>
<span class="go">    &#39;created_at&#39;: datetime.datetime(2020, 3, 1, 20, 28, 9, 346808)</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &quot;id&quot;: 1,</span>
<span class="go">    &quot;name&quot;: &quot;New Tournament&quot;,</span>
<span class="go">    &quot;created_at&quot;: &quot;2020-03-01T20:28:09.346808&quot;</span>
<span class="go">}</span>
</code></pre></div>
</div>
<h3 id="querysetlist">2: Queryset和List<a class="headerlink" href="#querysetlist" title="Link to this heading">¶</a></h3>
<p><strong>Querysets &amp; Lists</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2">
<input checked type="radio" id="__tabbed_3_1" name="__tabbed_3"><input type="radio" id="__tabbed_3_2" name="__tabbed_3"><div class="tabbed-labels docutils container">
<label class="tabbed-label" for="__tabbed_3_1">
中文</label><label class="tabbed-label" for="__tabbed_3_2">
英文</label></div>
<div class="tabbed-content docutils container">
<div class="tabbed-block docutils container">
<p>在这里，我们介绍：</p>
<ul class="simple">
<li><p>创建一个列表模型以序列化查询集</p></li>
<li><p>默认排序得以保留</p></li>
</ul>
<p>示例源代码： <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut2"><span class="std std-ref">2: Querysets &amp; Lists</span></a></p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">tortoise.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这是一个比赛的引用</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#: 比赛记录创建的日期时间</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="c1"># 定义默认排序</span>
        <span class="c1"># Pydantic 序列化器将使用此排序结果</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="line-block">
<div class="line">要从中创建 Pydantic 列表模型，可以调用：</div>
<div class="line"><a class="reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator (Python function) — Function to build a Pydantic Model list off Tortoise Model."><code class="xref py py-meth docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.pydantic_queryset_creator()</span></code></a></div>
</div>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise.contrib.pydantic</span> <span class="kn">import</span> <span class="n">pydantic_queryset_creator</span>

<span class="n">Tournament_Pydantic_List</span> <span class="o">=</span> <span class="n">pydantic_queryset_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>现在我们有了一个 <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic 模型</a>，可以用于表示架构和序列化。</p>
<p><code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic_List</span></code> 的 JSON 架构现在是：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic_List</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournaments&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;这是一个比赛的引用&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;array&#39;,</span>
<span class="go">    &#39;items&#39;: {</span>
<span class="go">        &#39;$ref&#39;: &#39;#/definitions/Tournament&#39;</span>
<span class="go">    },</span>
<span class="go">    &#39;definitions&#39;: {</span>
<span class="go">        &#39;Tournament&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;这是一个比赛的引用&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">            &#39;properties&#39;: {</span>
<span class="go">                &#39;id&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;name&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;created_at&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">                    &#39;description&#39;: &#39;比赛记录创建的日期时间&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">                    &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">                }</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>注意，<code class="docutils literal notranslate"><span class="pre">Tournament</span></code> 现在不是根对象。一个简单的列表是根对象。</p>
<p>要序列化一个对象，仅需 <em>(在异步上下文中)</em>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># 创建对象</span>
<span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;新比赛&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;另一个&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;最后一个比赛&quot;</span><span class="p">)</span>

<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic_List</span><span class="o">.</span><span class="n">from_queryset</span><span class="p">(</span><span class="n">Tournament</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</code></pre></div>
</div>
<p>可以使用 <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/exporting_models/">常规 Pydantic 对象方法</a> 获取内容，例如 <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code>。</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;root&#39;: [</span>
<span class="go">        {</span>
<span class="go">            &#39;id&#39;: 2,</span>
<span class="go">            &#39;name&#39;: &#39;另一个&#39;,</span>
<span class="go">            &#39;created_at&#39;: datetime.datetime(2020, 3, 2, 6, 53, 39, 776504)</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &#39;id&#39;: 3,</span>
<span class="go">            &#39;name&#39;: &#39;最后一个比赛&#39;,</span>
<span class="go">            &#39;created_at&#39;: datetime.datetime(2020, 3, 2, 6, 53, 39, 776848)</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &#39;id&#39;: 1,</span>
<span class="go">            &#39;name&#39;: &#39;新比赛&#39;,</span>
<span class="go">            &#39;created_at&#39;: datetime.datetime(2020, 3, 2, 6, 53, 39, 776211)</span>
<span class="go">        }</span>
<span class="go">    ]</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;id&quot;: 2,</span>
<span class="go">        &quot;name&quot;: &quot;另一个&quot;,</span>
<span class="go">        &quot;created_at&quot;: &quot;2020-03-02T06:53:39.776504&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;id&quot;: 3,</span>
<span class="go">        &quot;name&quot;: &quot;最后一个比赛&quot;,</span>
<span class="go">        &quot;created_at&quot;: &quot;2020-03-02T06:53:39.776848&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;id&quot;: 1,</span>
<span class="go">        &quot;name&quot;: &quot;新比赛&quot;,</span>
<span class="go">        &quot;created_at&quot;: &quot;2020-03-02T06:53:39.776211&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>
</code></pre></div>
</div>
<p>注意，<code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> 有一个 <code class="docutils literal notranslate"><span class="pre">root</span></code> 元素，包含列表，但 <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code> 将列表作为根元素。
同时注意结果按 <code class="docutils literal notranslate"><span class="pre">name</span></code> 字母顺序排序。</p>
</div>
<div class="tabbed-block docutils container">
<p>Here we introduce:</p>
<ul class="simple">
<li><p>Creating a list-model to serialise a queryset</p></li>
<li><p>Default sorting is honoured</p></li>
</ul>
<p>Source to example: <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut2"><span class="std std-ref">2: Querysets &amp; Lists</span></a></p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">tortoise.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This references a Tournament</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#: The date-time the Tournament record was created at</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="c1"># Define the default ordering</span>
        <span class="c1">#  the pydantic serialiser will use this to order the results</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="line-block">
<div class="line">To create a Pydantic list-model from that one would call:</div>
<div class="line"><a class="reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator (Python function) — Function to build a Pydantic Model list off Tortoise Model."><code class="xref py py-meth docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.pydantic_queryset_creator()</span></code></a></div>
</div>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise.contrib.pydantic</span> <span class="kn">import</span> <span class="n">pydantic_queryset_creator</span>

<span class="n">Tournament_Pydantic_List</span> <span class="o">=</span> <span class="n">pydantic_queryset_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>And now have a <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic Model</a> that can be used for representing schema and serialisation.</p>
<p>The JSON-Schema of <code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic_List</span></code> is now:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic_List</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournaments&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;This references a Tournament&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;array&#39;,</span>
<span class="go">    &#39;items&#39;: {</span>
<span class="go">        &#39;$ref&#39;: &#39;#/definitions/Tournament&#39;</span>
<span class="go">    },</span>
<span class="go">    &#39;definitions&#39;: {</span>
<span class="go">        &#39;Tournament&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;This references a Tournament&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">            &#39;properties&#39;: {</span>
<span class="go">                &#39;id&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;name&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;created_at&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">                    &#39;description&#39;: &#39;The date-time the Tournament record was created at&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">                    &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">                }</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">Tournament</span></code> is now not the root. A simple list is.</p>
<p>To serialise an object it is simply <em>(in an async context)</em>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Create objects</span>
<span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;New Tournament&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Another&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Last Tournament&quot;</span><span class="p">)</span>

<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic_List</span><span class="o">.</span><span class="n">from_queryset</span><span class="p">(</span><span class="n">Tournament</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</code></pre></div>
</div>
<p>And one could get the contents by using <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/exporting_models/">regular Pydantic-object methods</a>, such as <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> or <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code></p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;root&#39;: [</span>
<span class="go">        {</span>
<span class="go">            &#39;id&#39;: 2,</span>
<span class="go">            &#39;name&#39;: &#39;Another&#39;,</span>
<span class="go">            &#39;created_at&#39;: datetime.datetime(2020, 3, 2, 6, 53, 39, 776504)</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &#39;id&#39;: 3,</span>
<span class="go">            &#39;name&#39;: &#39;Last Tournament&#39;,</span>
<span class="go">            &#39;created_at&#39;: datetime.datetime(2020, 3, 2, 6, 53, 39, 776848)</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &#39;id&#39;: 1,</span>
<span class="go">            &#39;name&#39;: &#39;New Tournament&#39;,</span>
<span class="go">            &#39;created_at&#39;: datetime.datetime(2020, 3, 2, 6, 53, 39, 776211)</span>
<span class="go">        }</span>
<span class="go">    ]</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;id&quot;: 2,</span>
<span class="go">        &quot;name&quot;: &quot;Another&quot;,</span>
<span class="go">        &quot;created_at&quot;: &quot;2020-03-02T06:53:39.776504&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;id&quot;: 3,</span>
<span class="go">        &quot;name&quot;: &quot;Last Tournament&quot;,</span>
<span class="go">        &quot;created_at&quot;: &quot;2020-03-02T06:53:39.776848&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;id&quot;: 1,</span>
<span class="go">        &quot;name&quot;: &quot;New Tournament&quot;,</span>
<span class="go">        &quot;created_at&quot;: &quot;2020-03-02T06:53:39.776211&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>
</code></pre></div>
</div>
<p>Note how <code class="docutils literal notranslate"><span class="pre">.model_dump()</span></code> has a <code class="docutils literal notranslate"><span class="pre">root</span></code> element with the list, but the <code class="docutils literal notranslate"><span class="pre">.model_dump_json()</span></code> has the list as root.
Also note how the results are sorted alphabetically by <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
</div>
</div>
</div><h3 id="id6">3: 关系和初始化<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p><strong>Relations &amp; Early-init</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2">
<input checked type="radio" id="__tabbed_4_1" name="__tabbed_4"><input type="radio" id="__tabbed_4_2" name="__tabbed_4"><div class="tabbed-labels docutils container">
<label class="tabbed-label" for="__tabbed_4_1">
中文</label><label class="tabbed-label" for="__tabbed_4_2">
英文</label></div>
<div class="tabbed-content docutils container">
<div class="tabbed-block docutils container">
<p>在这里，我们介绍：</p>
<ul class="simple">
<li><p>关系</p></li>
<li><p>早期模型初始化</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>本教程关于早期初始化的部分仅在您需要在初始化 Tortoise ORM <strong>之前</strong> 生成 Pydantic 模型时才需要。</p>
<p>请查看 <a class="reference internal" href="../examples/pydantic.html#example-pydantic-basic"><span class="std std-ref">基本用法</span></a> （在函数 <code class="docutils literal notranslate"><span class="pre">run</span></code> 中）以了解 <code class="docutils literal notranslate"><span class="pre">*_creator</span></code> 仅在我们正确初始化 Tortoise ORM 之后被调用，在这种情况下不需要早期初始化。</p>
</div>
<p>示例源代码： <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut3"><span class="std std-ref">3: Relations &amp; Early-init</span></a></p>
<p>我们定义带有关系的模型：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">tortoise.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这是一个比赛的引用</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#: 比赛记录创建的日期时间</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这是比赛中的一个事件的引用</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">tournament</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span>
        <span class="s2">&quot;models.Tournament&quot;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;该事件发生的比赛&quot;</span>
    <span class="p">)</span>
</code></pre></div>
</div>
<p>接下来，我们使用 <code class="docutils literal notranslate"><span class="pre">pydantic_model_creator</span></code> 创建我们的 <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic 模型</a>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise.contrib.pydantic</span> <span class="kn">import</span> <span class="n">pydantic_model_creator</span>

<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> 的 JSON 架构现在是：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;这是一个比赛的引用&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">    &#39;properties&#39;: {</span>
<span class="go">        &#39;id&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;name&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;created_at&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;比赛记录创建的日期时间&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">            &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>哦不！关系在哪里？</p>
<p>因为模型尚未完全初始化，所以此时它不知道关系。</p>
<p>我们需要使用 <a class="reference internal" href="../setup.html#tortoise.Tortoise.init_models" title="tortoise.Tortoise.init_models (Python method) — Early initialisation of Tortoise ORM Models."><code class="xref py py-meth docutils literal notranslate"><span class="pre">tortoise.Tortoise.init_models()</span></code></a> 早期初始化模型关系。</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">Tortoise</span>

<span class="n">Tortoise</span><span class="o">.</span><span class="n">init_models</span><span class="p">([</span><span class="s2">&quot;__main__&quot;</span><span class="p">],</span> <span class="s2">&quot;models&quot;</span><span class="p">)</span>
<span class="c1"># 现在再试一次</span>
<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> 的 JSON 架构现在是：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;这是一个比赛的引用&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">    &#39;properties&#39;: {</span>
<span class="go">        &#39;id&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;name&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;created_at&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;比赛记录创建的日期时间&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">            &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;events&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Events&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;该事件发生的比赛&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;array&#39;,</span>
<span class="go">            &#39;items&#39;: {</span>
<span class="go">                &#39;$ref&#39;: &#39;#/definitions/Event&#39;</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    },</span>
<span class="go">    &#39;definitions&#39;: {</span>
<span class="go">        &#39;Event&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Event&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;这是比赛中的一个事件的引用&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">            &#39;properties&#39;: {</span>
<span class="go">                &#39;id&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;name&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;created_at&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">                    &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">                }</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>啊哈！这好得多。</p>
<p>注意，我们也可以以相同的方式为 <code class="docutils literal notranslate"><span class="pre">Event</span></code> 创建一个模型，它应该可以正常工作：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">Event_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Event</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">Event_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;这是比赛中的一个事件的引用&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Id&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Created At&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date-time&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;tournament&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Tournament&#39;</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;该事件发生的比赛&#39;</span><span class="p">,</span>
            <span class="s1">&#39;allOf&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="s1">&#39;#/definitions/Tournament&#39;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;definitions&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;Tournament&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Tournament&#39;</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;这是一个比赛的引用&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
            <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span>
                <span class="p">},</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span>
                <span class="p">},</span>
                <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Created At&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;比赛记录创建的日期时间&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date-time&#39;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>并且也定义了关系！</p>
<p>注意，这两个架构都没有反向跟随关系。这是默认设置，稍后的教程中我们将展示相关选项。</p>
<p>让我们创建并序列化对象，看看它们的样子 <em>(在异步上下文中)</em>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># 创建对象</span>
<span class="n">tournament</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;新比赛&quot;</span><span class="p">)</span>
<span class="n">event</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Event</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;事件&quot;</span><span class="p">,</span> <span class="n">tournament</span><span class="o">=</span><span class="n">tournament</span><span class="p">)</span>

<span class="c1"># 序列化比赛</span>
<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">tournament</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;新比赛&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.731656&quot;</span><span class="p">,</span>
    <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;事件&quot;</span><span class="p">,</span>
            <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.732492&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>并序列化事件 <em>(在异步上下文中)</em>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eventpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Event_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">eventpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;事件&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.732492&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tournament&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;新比赛&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.731656&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
<div class="tabbed-block docutils container">
<p>Here we introduce:</p>
<ul class="simple">
<li><p>Relationships</p></li>
<li><p>Early model init</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>The part of this tutorial about early-init is only required if you need to generate the pydantic models <strong>before</strong> you have initialised Tortoise ORM.</p>
<p>Look at <a class="reference internal" href="../examples/pydantic.html#example-pydantic-basic"><span class="std std-ref">基本用法</span></a> (in function <code class="docutils literal notranslate"><span class="pre">run</span></code>) to see where the <code class="docutils literal notranslate"><span class="pre">*_creator</span> <span class="pre">is</span> <span class="pre">only</span></code> called <strong>after</strong> we initialised Tortoise ORM properly, in that case an early init is not needed.</p>
</div>
<p>Source to example: <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut3"><span class="std std-ref">3: Relations &amp; Early-init</span></a></p>
<p>We define our models with a relationship:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">tortoise.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This references a Tournament</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="c1">#: The date-time the Tournament record was created at</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This references an Event in a Tournament</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">tournament</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span>
        <span class="s2">&quot;models.Tournament&quot;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The Tournament this happens in&quot;</span>
    <span class="p">)</span>
</code></pre></div>
</div>
<p>Next we create our <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic Model</a> using <code class="docutils literal notranslate"><span class="pre">pydantic_model_creator</span></code>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise.contrib.pydantic</span> <span class="kn">import</span> <span class="n">pydantic_model_creator</span>

<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The JSON-Schema of <code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> is now:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;This references a Tournament&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">    &#39;properties&#39;: {</span>
<span class="go">        &#39;id&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;name&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;created_at&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;The date-time the Tournament record was created at&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">            &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>Oh no! Where is the relation?</p>
<p>Because the models have not fully initialised, it doesn’t know about the relations at this stage.</p>
<p>We need to initialise our model relationships early using <a class="reference internal" href="../setup.html#tortoise.Tortoise.init_models" title="tortoise.Tortoise.init_models (Python method) — Early initialisation of Tortoise ORM Models."><code class="xref py py-meth docutils literal notranslate"><span class="pre">tortoise.Tortoise.init_models()</span></code></a></p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">Tortoise</span>

<span class="n">Tortoise</span><span class="o">.</span><span class="n">init_models</span><span class="p">([</span><span class="s2">&quot;__main__&quot;</span><span class="p">],</span> <span class="s2">&quot;models&quot;</span><span class="p">)</span>
<span class="c1"># Now lets try again</span>
<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The JSON-Schema of <code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> is now:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">{</span>
<span class="go">    &#39;title&#39;: &#39;Tournament&#39;,</span>
<span class="go">    &#39;description&#39;: &#39;This references a Tournament&#39;,</span>
<span class="go">    &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">    &#39;properties&#39;: {</span>
<span class="go">        &#39;id&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;name&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;created_at&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;The date-time the Tournament record was created at&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">            &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">        },</span>
<span class="go">        &#39;events&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Events&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;The Tournament this happens in&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;array&#39;,</span>
<span class="go">            &#39;items&#39;: {</span>
<span class="go">                &#39;$ref&#39;: &#39;#/definitions/Event&#39;</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    },</span>
<span class="go">    &#39;definitions&#39;: {</span>
<span class="go">        &#39;Event&#39;: {</span>
<span class="go">            &#39;title&#39;: &#39;Event&#39;,</span>
<span class="go">            &#39;description&#39;: &#39;This references an Event in a Tournament&#39;,</span>
<span class="go">            &#39;type&#39;: &#39;object&#39;,</span>
<span class="go">            &#39;properties&#39;: {</span>
<span class="go">                &#39;id&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Id&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;integer&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;name&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Name&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;</span>
<span class="go">                },</span>
<span class="go">                &#39;created_at&#39;: {</span>
<span class="go">                    &#39;title&#39;: &#39;Created At&#39;,</span>
<span class="go">                    &#39;type&#39;: &#39;string&#39;,</span>
<span class="go">                    &#39;format&#39;: &#39;date-time&#39;</span>
<span class="go">                }</span>
<span class="go">            }</span>
<span class="go">        }</span>
<span class="go">    }</span>
<span class="go">}</span>
</code></pre></div>
</div>
<p>Aha! that’s much better.</p>
<p>Note we can also create a model for <code class="docutils literal notranslate"><span class="pre">Event</span></code> the same way, and it should just work:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">Event_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Event</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">Event_Pydantic</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Event&#39;</span><span class="p">,</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;This references an Event in a Tournament&#39;</span><span class="p">,</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
    <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Id&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Created At&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date-time&#39;</span>
        <span class="p">},</span>
        <span class="s1">&#39;tournament&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Tournament&#39;</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;The Tournament this happens in&#39;</span><span class="p">,</span>
            <span class="s1">&#39;allOf&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="s1">&#39;#/definitions/Tournament&#39;</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;definitions&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;Tournament&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Tournament&#39;</span><span class="p">,</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;This references a Tournament&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span>
            <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span>
                <span class="p">},</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span>
                <span class="p">},</span>
                <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Created At&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;The date-time the Tournament record was created at&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date-time&#39;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>And that also has the relation defined!</p>
<p>Note how both schema’s don’t follow relations back. This is on by default, and in a later tutorial we will show the options.</p>
<p>Lets create and serialise the objects and see what they look like <em>(in an async context)</em>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Create objects</span>
<span class="n">tournament</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;New Tournament&quot;</span><span class="p">)</span>
<span class="n">event</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Event</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;The Event&quot;</span><span class="p">,</span> <span class="n">tournament</span><span class="o">=</span><span class="n">tournament</span><span class="p">)</span>

<span class="c1"># Serialise Tournament</span>
<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">tournament</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;New Tournament&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.731656&quot;</span><span class="p">,</span>
    <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;The Event&quot;</span><span class="p">,</span>
            <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.732492&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>And serialising the event <em>(in an async context)</em>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eventpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Event_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">eventpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;The Event&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.732492&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tournament&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;New Tournament&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-03-02T07:23:27.731656&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
</div><h3 id="pydanticmeta-callables">4: PydanticMeta 和 Callables<a class="headerlink" href="#pydanticmeta-callables" title="Link to this heading">¶</a></h3>
<p><strong>PydanticMeta &amp; Callables</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2">
<input checked type="radio" id="__tabbed_5_1" name="__tabbed_5"><input type="radio" id="__tabbed_5_2" name="__tabbed_5"><div class="tabbed-labels docutils container">
<label class="tabbed-label" for="__tabbed_5_1">
中文</label><label class="tabbed-label" for="__tabbed_5_2">
英文</label></div>
<div class="tabbed-content docutils container">
<div class="tabbed-block docutils container">
<p>在这里，我们介绍：</p>
<ul class="simple">
<li><p>通过 <code class="docutils literal notranslate"><span class="pre">PydanticMeta</span></code> 类配置模型创建器。</p></li>
<li><p>使用可调用函数注释额外数据。</p></li>
</ul>
<p>示例源代码： <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut4"><span class="std std-ref">4: PydanticMeta &amp; Callables</span></a></p>
<p>让我们添加一些计算数据的方法，并告诉创建器使用它们：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这是一个比赛的引用</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># 手动定义反向关系是有用的，这样类型检查</span>
    <span class="c1">#  和自动完成才能正常工作</span>
    <span class="n">events</span><span class="p">:</span> <span class="n">fields</span><span class="o">.</span><span class="n">ReverseRelation</span><span class="p">[</span><span class="s2">&quot;Event&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">name_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        计算名称的长度</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">events_num</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        计算事件数量</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoValuesFetched</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">class</span> <span class="nc">PydanticMeta</span><span class="p">:</span>
        <span class="c1"># 排除创建时间戳</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;created_at&quot;</span><span class="p">,)</span>
        <span class="c1"># 包含两个可调用函数作为计算列</span>
        <span class="n">computed</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;name_length&quot;</span><span class="p">,</span> <span class="s2">&quot;events_num&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    这是比赛中的一个事件的引用</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">tournament</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span>
        <span class="s2">&quot;models.Tournament&quot;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;该事件发生的比赛&quot;</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">PydanticMeta</span><span class="p">:</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;created_at&quot;</span><span class="p">,)</span>
</code></pre></div>
</div>
<p>这里有很多内容需要解释。</p>
<p>首先，我们定义了一个 <code class="docutils literal notranslate"><span class="pre">PydanticMeta</span></code> 块，里面是 Pydantic 模型创建器的配置选项。
请参见 <a class="reference internal" href="#tortoise.contrib.pydantic.creator.PydanticMeta" title="tortoise.contrib.pydantic.creator.PydanticMeta (Python class) — The PydanticMeta class is used to configure metadata for generating the pydantic Model."><code class="xref py py-class docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.PydanticMeta</span></code></a> 以了解可用选项。</p>
<p>其次，我们在两个模型中都排除了 <code class="docutils literal notranslate"><span class="pre">created_at</span></code>，因为我们认为它没有提供任何好处。</p>
<p>第三，我们添加了两个可调用函数： <code class="docutils literal notranslate"><span class="pre">name_length</span></code> 和 <code class="docutils literal notranslate"><span class="pre">events_num</span></code>。我们希望这些成为结果集的一部分。
请注意，可调用函数/计算字段需要手动指定返回类型，因为如果没有这个，我们无法确定创建有效 Pydantic 架构所需的记录类型。
这对于标准 Tortoise ORM 字段来说是不需要的，因为字段已经定义了有效的类型。</p>
<p>请注意，Pydantic 序列化器不能调用异步方法，但由于 Tortoise 辅助函数预先获取关系数据，因此在序列化之前可以使用它。
所以我们不需要等待关系。
然而，我们应该防止没有预获取的情况，因此需要捕获和处理 <code class="docutils literal notranslate"><span class="pre">tortoise.exceptions.NoValuesFetched</span></code> 异常。</p>
<p>接下来，我们使用 <code class="docutils literal notranslate"><span class="pre">pydantic_model_creator</span></code> 创建我们的 <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic 模型</a>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">Tortoise</span>

<span class="n">Tortoise</span><span class="o">.</span><span class="n">init_models</span><span class="p">([</span><span class="s2">&quot;__main__&quot;</span><span class="p">],</span> <span class="s2">&quot;models&quot;</span><span class="p">)</span>
<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> 的 JSON 架构现在是：</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Tournament&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;这是一个比赛的引用&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;events&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Events&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;该事件发生的比赛&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/Event&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;name_length&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name Length&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;计算名称的长度&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;events_num&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Events Num&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;计算事件数量。&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;definitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Event&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;这是比赛中的一个事件的引用&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>注意 <code class="docutils literal notranslate"><span class="pre">created_at</span></code> 被移除，<code class="docutils literal notranslate"><span class="pre">name_length</span></code> 和 <code class="docutils literal notranslate"><span class="pre">events_num</span></code> 被添加。</p>
<p>让我们创建并序列化对象，看看它们的样子 <em>(在异步上下文中)</em>：</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># 创建对象</span>
<span class="n">tournament</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;新比赛&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Event</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;事件 1&quot;</span><span class="p">,</span> <span class="n">tournament</span><span class="o">=</span><span class="n">tournament</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Event</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;事件 2&quot;</span><span class="p">,</span> <span class="n">tournament</span><span class="o">=</span><span class="n">tournament</span><span class="p">)</span>

<span class="c1"># 序列化比赛</span>
<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">tournament</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;新比赛&quot;</span><span class="p">,</span>
    <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;事件 1&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;事件 2&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;name_length&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s2">&quot;events_num&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
<div class="tabbed-block docutils container">
<p>Here we introduce:</p>
<ul class="simple">
<li><p>Configuring model creator via <code class="docutils literal notranslate"><span class="pre">PydanticMeta</span></code> class.</p></li>
<li><p>Using callable functions to annotate extra data.</p></li>
</ul>
<p>Source to example: <a class="reference internal" href="../examples/pydantic.html#example-pydantic-tut4"><span class="std std-ref">4: PydanticMeta &amp; Callables</span></a></p>
<p>Let’s add some methods that calculate data, and tell the creators to use them:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Tournament</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This references a Tournament</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># It is useful to define the reverse relations manually so that type checking</span>
    <span class="c1">#  and auto completion work</span>
    <span class="n">events</span><span class="p">:</span> <span class="n">fields</span><span class="o">.</span><span class="n">ReverseRelation</span><span class="p">[</span><span class="s2">&quot;Event&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">name_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computed length of name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">events_num</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computed team size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoValuesFetched</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">class</span> <span class="nc">PydanticMeta</span><span class="p">:</span>
        <span class="c1"># Let&#39;s exclude the created timestamp</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;created_at&quot;</span><span class="p">,)</span>
        <span class="c1"># Let&#39;s include two callables as computed columns</span>
        <span class="n">computed</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;name_length&quot;</span><span class="p">,</span> <span class="s2">&quot;events_num&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This references an Event in a Tournament</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">created_at</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DatetimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">tournament</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span>
        <span class="s2">&quot;models.Tournament&quot;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The Tournament this happens in&quot;</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

    <span class="k">class</span> <span class="nc">PydanticMeta</span><span class="p">:</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;created_at&quot;</span><span class="p">,)</span>
</code></pre></div>
</div>
<p>There is much to unpack here.</p>
<p>Firstly, we defined a <code class="docutils literal notranslate"><span class="pre">PydanticMeta</span></code> block, and in there is configuration options for the pydantic model creator.
See <a class="reference internal" href="#tortoise.contrib.pydantic.creator.PydanticMeta" title="tortoise.contrib.pydantic.creator.PydanticMeta (Python class) — The PydanticMeta class is used to configure metadata for generating the pydantic Model."><code class="xref py py-class docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.PydanticMeta</span></code></a> for the available options.</p>
<p>Secondly, we excluded <code class="docutils literal notranslate"><span class="pre">created_at</span></code> in both models, as we decided it provided no benefit.</p>
<p>Thirly, we added two callables: <code class="docutils literal notranslate"><span class="pre">name_length</span></code> and <code class="docutils literal notranslate"><span class="pre">events_num</span></code>. We want these as part of the result set.
Note that callables/computed fields require manual specification of return type, as without this we can’t determine the record type which is needed to create a valid Pydantic schema.
This is not needed for standard Tortoise ORM fields, as the fields already define a valid type.</p>
<p>Note that the Pydantic serializer can’t call async methods, but since the tortoise helpers pre-fetch relational data, it is available before serialization.
So we don’t need to await the relation.
We should however protect against the case where no prefetching was done, hence catching and handling the <code class="docutils literal notranslate"><span class="pre">tortoise.exceptions.NoValuesFetched</span></code> exception.</p>
<p>Next we create our <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic Model</a> using <code class="docutils literal notranslate"><span class="pre">pydantic_model_creator</span></code>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tortoise</span> <span class="kn">import</span> <span class="n">Tortoise</span>

<span class="n">Tortoise</span><span class="o">.</span><span class="n">init_models</span><span class="p">([</span><span class="s2">&quot;__main__&quot;</span><span class="p">],</span> <span class="s2">&quot;models&quot;</span><span class="p">)</span>
<span class="n">Tournament_Pydantic</span> <span class="o">=</span> <span class="n">pydantic_model_creator</span><span class="p">(</span><span class="n">Tournament</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The JSON-Schema of <code class="docutils literal notranslate"><span class="pre">Tournament_Pydantic</span></code> is now:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Tournament&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This references a Tournament&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;events&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Events&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The Tournament this happens in&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/Event&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;name_length&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name Length&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Computes length of name&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;events_num&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Events Num&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Computes team size.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;definitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Event&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Event&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This references an Event in a Tournament&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Id&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">created_at</span></code> is removed, and <code class="docutils literal notranslate"><span class="pre">name_length</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">events_num</span></code> is added.</p>
<p>Lets create and serialise the objects and see what they look like <em>(in an async context)</em>:</p>
<div class="highlight-py3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Create objects</span>
<span class="n">tournament</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;New Tournament&quot;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Event</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Event 1&quot;</span><span class="p">,</span> <span class="n">tournament</span><span class="o">=</span><span class="n">tournament</span><span class="p">)</span>
<span class="k">await</span> <span class="n">Event</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Event 2&quot;</span><span class="p">,</span> <span class="n">tournament</span><span class="o">=</span><span class="n">tournament</span><span class="p">)</span>

<span class="c1"># Serialise Tournament</span>
<span class="n">tourpy</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Tournament_Pydantic</span><span class="o">.</span><span class="n">from_tortoise_orm</span><span class="p">(</span><span class="n">tournament</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">tourpy</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>
<span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;New Tournament&quot;</span><span class="p">,</span>
    <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Event 1&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Event 2&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;name_length&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s2">&quot;events_num&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
</div><h2 id="id7">创建器<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h2>
<p><strong>Creators</strong></p>
<dl class="py function objdesc" id="module-tortoise.contrib.pydantic.creator">
<dt class="sig sig-object highlight sig-wrap py" id="tortoise.contrib.pydantic.creator.pydantic_model_creator">
<span class="sig-prename descclassname"><span class="pre">tortoise.contrib.pydantic.creator.</span></span><span class="sig-name descname"><span class="pre">pydantic_model_creator</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.cls" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.cls (Python parameter) — The Tortoise Model"><span class="n"><span class="pre">cls</span></span></a></em>, </span><span class="sig-param-decl"><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.name" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.name (Python parameter) — Specify a custom name explicitly, instead of a generated name."><span class="n"><span class="pre">name</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude (Python parameter) — Extra fields to exclude from the provided model."><span class="n"><span class="pre">exclude</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.include" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.include (Python parameter) — Extra fields to include from the provided model."><span class="n"><span class="pre">include</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.computed" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.computed (Python parameter) — Extra computed fields to include from the provided model."><span class="n"><span class="pre">computed</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.optional" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.optional (Python parameter) — Extra optional fields for the provided model."><span class="n"><span class="pre">optional</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.allow_cycles" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.allow_cycles (Python parameter) — Do we allow any cycles in the generated model? This is only useful for recursive/self-referential models."><span class="n"><span class="pre">allow_cycles</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.sort_alphabetically" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.sort_alphabetically (Python parameter) — Sort the parameters alphabetically instead of Field-definition order."><span class="n"><span class="pre">sort_alphabetically</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator._stack" title="tortoise.contrib.pydantic.creator.pydantic_model_creator._stack (Python parameter) — Internal parameter to track recursion"><span class="n"><span class="pre">_stack</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude_readonly" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude_readonly (Python parameter) — Build a subset model that excludes any readonly fields"><span class="n"><span class="pre">exclude_readonly</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.meta_override" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.meta_override (Python parameter) — A PydanticMeta class to override model's values."><span class="n"><span class="pre">meta_override</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.model_config" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.model_config (Python parameter) — A custom config to use as pydantic config."><span class="n"><span class="pre">model_config</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.validators" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.validators (Python parameter) — A dictionary of methods that validate fields."><span class="n"><span class="pre">validators</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.module" title="tortoise.contrib.pydantic.creator.pydantic_model_creator.module (Python parameter) — The name of the module that the model belongs to."><span class="n"><span class="pre">module</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;tortoise.contrib.pydantic.creator&#39;</span></code></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/creator.html#pydantic_model_creator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator" title="Link to this definition">¶</a></dt>
<dd><p>Function to build <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic Model</a> off Tortoise Model.</p>
<dl class="field-list simple">
<dt class="field-odd" id="tortoise.contrib.pydantic.creator.pydantic_model_creator-parameters">Parameters<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator-parameters" title="Permalink to this headline">¶</a></dt>
<dd class="field-odd"><dl class="simple api-field highlight">
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator._stack"><span class="n sig-name">_stack</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator._stack" title="Permalink to this definition">¶</a></dt><dd><p>Internal parameter to track recursion</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.cls"><span class="n sig-name">cls</span><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.cls" title="Permalink to this definition">¶</a></dt><dd><p>The Tortoise Model</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.name"><span class="n sig-name">name</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.name" title="Permalink to this definition">¶</a></dt><dd><p>Specify a custom name explicitly, instead of a generated name.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude"><span class="n sig-name">exclude</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude" title="Permalink to this definition">¶</a></dt><dd><p>Extra fields to exclude from the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.include"><span class="n sig-name">include</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.include" title="Permalink to this definition">¶</a></dt><dd><p>Extra fields to include from the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.computed"><span class="n sig-name">computed</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.computed" title="Permalink to this definition">¶</a></dt><dd><p>Extra computed fields to include from the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.optional"><span class="n sig-name">optional</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.optional" title="Permalink to this definition">¶</a></dt><dd><p>Extra optional fields for the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.allow_cycles"><span class="n sig-name">allow_cycles</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.allow_cycles" title="Permalink to this definition">¶</a></dt><dd><p><p>Do we allow any cycles in the generated model?
This is only useful for recursive/self-referential models.</p>
<p>A value of <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default) will prevent any and all backtracking.</p>
</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.sort_alphabetically"><span class="n sig-name">sort_alphabetically</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.sort_alphabetically" title="Permalink to this definition">¶</a></dt><dd><p><p>Sort the parameters alphabetically instead of Field-definition order.</p>
<p>The default order would be:</p>
<blockquote>
<div><ul class="simple">
<li><p>Field definition order +</p></li>
<li><p>order of reverse relations (as discovered) +</p></li>
<li><p>order of computed functions (as provided).</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude_readonly"><span class="n sig-name">exclude_readonly</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.exclude_readonly" title="Permalink to this definition">¶</a></dt><dd><p>Build a subset model that excludes any readonly fields</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.meta_override"><span class="n sig-name">meta_override</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.meta_override" title="Permalink to this definition">¶</a></dt><dd><p>A PydanticMeta class to override model’s values.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.model_config"><span class="n sig-name">model_config</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.model_config" title="Permalink to this definition">¶</a></dt><dd><p>A custom config to use as pydantic config.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.validators"><span class="n sig-name">validators</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.validators" title="Permalink to this definition">¶</a></dt><dd><p>A dictionary of methods that validate fields.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_model_creator.module"><span class="n sig-name">module</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;tortoise.contrib.pydantic.creator&#39;</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator.module" title="Permalink to this definition">¶</a></dt><dd><p><p>The name of the module that the model belongs to.</p>
<dl class="simple">
<dt>Note: Created pydantic model uses config_class parameter and PydanticMeta’s</dt><dd><p>config_class as its Config class’s bases(Only if provided!), but it
ignores <code class="docutils literal notranslate"><span class="pre">fields</span></code> config. pydantic_model_creator will generate fields by
include/exclude/computed parameters automatically.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd>
<dt class="field-even" id="tortoise.contrib.pydantic.creator.pydantic_model_creator-return-type">Return type<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_model_creator-return-type" title="Permalink to this headline">¶</a></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#tortoise.contrib.pydantic.base.PydanticModel" title="tortoise.contrib.pydantic.base.PydanticModel (Python class) — Pydantic BaseModel for Tortoise objects."><code class="xref py py-class docutils literal notranslate"><span class="pre">PydanticModel</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator">
<span class="sig-prename descclassname"><span class="pre">tortoise.contrib.pydantic.creator.</span></span><span class="sig-name descname"><span class="pre">pydantic_queryset_creator</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.cls" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.cls (Python parameter) — The Tortoise Model to put in a list."><span class="n"><span class="pre">cls</span></span></a></em>, </span><span class="sig-param-decl"><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.name" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.name (Python parameter) — Specify a custom name explicitly, instead of a generated name."><span class="n"><span class="pre">name</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.exclude" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.exclude (Python parameter) — Extra fields to exclude from the provided model."><span class="n"><span class="pre">exclude</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.include" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.include (Python parameter) — Extra fields to include from the provided model."><span class="n"><span class="pre">include</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.computed" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.computed (Python parameter) — Extra computed fields to include from the provided model."><span class="n"><span class="pre">computed</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.allow_cycles" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.allow_cycles (Python parameter) — Do we allow any cycles in the generated model? This is only useful for recursive/self-referential models."><span class="n"><span class="pre">allow_cycles</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.sort_alphabetically" title="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.sort_alphabetically (Python parameter) — Sort the parameters alphabetically instead of Field-definition order."><span class="n"><span class="pre">sort_alphabetically</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/creator.html#pydantic_queryset_creator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator" title="Link to this definition">¶</a></dt>
<dd><p>Function to build a <a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/">Pydantic Model</a> list off Tortoise Model.</p>
<dl class="field-list simple">
<dt class="field-odd" id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator-parameters">Parameters<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator-parameters" title="Permalink to this headline">¶</a></dt>
<dd class="field-odd"><dl class="simple api-field highlight">
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.cls"><span class="n sig-name">cls</span><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.cls" title="Permalink to this definition">¶</a></dt><dd><p>The Tortoise Model to put in a list.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.name"><span class="n sig-name">name</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.name" title="Permalink to this definition">¶</a></dt><dd><p><p>Specify a custom name explicitly, instead of a generated name.</p>
<p>The list generated name is currently naive and merely adds a “s” to the end
of the singular name.</p>
</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.exclude"><span class="n sig-name">exclude</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.exclude" title="Permalink to this definition">¶</a></dt><dd><p>Extra fields to exclude from the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.include"><span class="n sig-name">include</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.include" title="Permalink to this definition">¶</a></dt><dd><p>Extra fields to include from the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.computed"><span class="n sig-name">computed</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.computed" title="Permalink to this definition">¶</a></dt><dd><p>Extra computed fields to include from the provided model.</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.allow_cycles"><span class="n sig-name">allow_cycles</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.allow_cycles" title="Permalink to this definition">¶</a></dt><dd><p><p>Do we allow any cycles in the generated model?
This is only useful for recursive/self-referential models.</p>
<p>A value of <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default) will prevent any and all backtracking.</p>
</p>
</dd>
<dt id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator.sort_alphabetically"><span class="n sig-name">sort_alphabetically</span><span class="o">=</span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator.sort_alphabetically" title="Permalink to this definition">¶</a></dt><dd><p><p>Sort the parameters alphabetically instead of Field-definition order.</p>
<p>The default order would be:</p>
<blockquote>
<div><ul class="simple">
<li><p>Field definition order +</p></li>
<li><p>order of reverse relations (as discovered) +</p></li>
<li><p>order of computed functions (as provided).</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd>
<dt class="field-even" id="tortoise.contrib.pydantic.creator.pydantic_queryset_creator-return-type">Return type<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.creator.pydantic_queryset_creator-return-type" title="Permalink to this headline">¶</a></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#tortoise.contrib.pydantic.base.PydanticListModel" title="tortoise.contrib.pydantic.base.PydanticListModel (Python class) — Pydantic BaseModel for List of Tortoise Models"><code class="xref py py-class docutils literal notranslate"><span class="pre">PydanticListModel</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<h2 id="pydanticmeta">PydanticMeta<a class="headerlink" href="#pydanticmeta" title="Link to this heading">¶</a></h2>
<dl class="py class objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tortoise.contrib.pydantic.creator.</span></span><span class="sig-name descname"><span class="pre">PydanticMeta</span></span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/creator.html#PydanticMeta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta" title="Link to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">PydanticMeta</span></code> class is used to configure metadata for generating the pydantic Model.</p>
<p>Usage:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">class</span> <span class="nc">PydanticMeta</span><span class="p">:</span>
        <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;baa&quot;</span><span class="p">)</span>
        <span class="n">computed</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;count_peanuts&quot;</span><span class="p">,</span> <span class="p">)</span>
</code></pre></div>
</div>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.allow_cycles">
<span class="sig-name descname"><span class="pre">allow_cycles</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">bool</span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="kc">False</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.allow_cycles" title="Link to this definition">¶</a></dt>
<dd><p>Allow cycles in recursion - This can result in HUGE data - Be careful!
Please use this with <code class="docutils literal notranslate"><span class="pre">exclude</span></code>/<code class="docutils literal notranslate"><span class="pre">include</span></code> and sane <code class="docutils literal notranslate"><span class="pre">max_recursion</span></code></p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.backward_relations">
<span class="sig-name descname"><span class="pre">backward_relations</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">bool</span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="kc">True</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.backward_relations" title="Link to this definition">¶</a></dt>
<dd><p>Use backward relations without annotations - not recommended, it can be huge data
without control</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.computed">
<span class="sig-name descname"><span class="pre">computed</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.computed" title="Link to this definition">¶</a></dt>
<dd><p>Computed fields can be listed here to use in pydantic model</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.exclude">
<span class="sig-name descname"><span class="pre">exclude</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">(</span><span class="s1">&#39;Meta&#39;</span><span class="p">,)</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.exclude" title="Link to this definition">¶</a></dt>
<dd><p>Fields listed in this property will be excluded from pydantic model</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.exclude_raw_fields">
<span class="sig-name descname"><span class="pre">exclude_raw_fields</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">bool</span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="kc">True</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.exclude_raw_fields" title="Link to this definition">¶</a></dt>
<dd><p>If we should exclude raw fields (the ones have _id suffixes) of relations</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.include">
<span class="sig-name descname"><span class="pre">include</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">()</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.include" title="Link to this definition">¶</a></dt>
<dd><p>If not empty, only fields this property contains will be in the pydantic model</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.max_recursion">
<span class="sig-name descname"><span class="pre">max_recursion</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">int</span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="mi">3</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.max_recursion" title="Link to this definition">¶</a></dt>
<dd><p>Maximum recursion level allowed</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ConfigDict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="kc">None</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Allows user to specify custom config for generated model</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.creator.PydanticMeta.sort_alphabetically">
<span class="sig-name descname"><span class="pre">sort_alphabetically</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">bool</span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="kc">False</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.creator.PydanticMeta.sort_alphabetically" title="Link to this definition">¶</a></dt>
<dd><p>Sort fields alphabetically.
If not set (or <code class="docutils literal notranslate"><span class="pre">False</span></code>) then leave fields in declaration order</p>
</dd></dl>

</dd></dl>

<h2 id="id8">模型类<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h2>
<p><strong>Model classes</strong></p>
<dl class="py class objdesc" id="module-tortoise.contrib.pydantic.base">
<dt class="sig sig-object highlight sig-wrap py" id="tortoise.contrib.pydantic.base.PydanticListModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tortoise.contrib.pydantic.base.</span></span><span class="sig-name descname"><span class="pre">PydanticListModel</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticListModel" title="tortoise.contrib.pydantic.base.PydanticListModel.__init__.root (Python parameter)"><span class="n"><span class="pre">root</span></span></a><span class="o"><span class="pre">=</span></span><code class="code python default_value docutils literal highlight highlight-python"><span class="n">PydanticUndefined</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><span class="o"><span class="pre">**</span></span><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticListModel" title="tortoise.contrib.pydantic.base.PydanticListModel.__init__.data (Python parameter)"><span class="n"><span class="pre">data</span></span></a></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/base.html#PydanticListModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel" title="Link to this definition">¶</a></dt>
<dd><p>Pydantic BaseModel for List of Tortoise Models</p>
<p>This provides an extra method above the usual Pydantic
<a class="reference external" href="https://pydantic-docs.helpmanual.io/usage/models/#model-properties">model properties</a></p>
<dl class="py method objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset">
<em class="property"><span class="pre">async</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_queryset</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset.queryset" title="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset.queryset (Python parameter) — a queryset on the model this PydanticListModel is based on."><span class="n"><span class="pre">queryset</span></span></a></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/base.html#PydanticListModel.from_queryset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset" title="Link to this definition">¶</a></dt>
<dd><p>Returns a serializable pydantic model instance that contains a list of models,
from the provided queryset.</p>
<p>This will prefetch all the relations automatically.</p>
<dl class="field-list simple">
<dt class="field-odd" id="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset-parameters">Parameters<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset-parameters" title="Permalink to this headline">¶</a></dt>
<dd class="field-odd"><dl class="simple api-field highlight">
<dt id="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset.queryset"><span class="sig-name descname">queryset</span><span class="p"> : </span><span class="desctype"><span class="desctype"><a class="reference internal" href="../query.html#id3" title="tortoise.queryset.QuerySet (Python class) — Parameterizes a generic class.">QuerySet</a></span></span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset.queryset" title="Permalink to this definition">¶</a></dt><dd><p>a queryset on the model this PydanticListModel is based on.</p>
</dd>
</dl>
</dd>
<dt class="field-even" id="tortoise.contrib.pydantic.base.PydanticListModel.from_queryset-return-type">Return type<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.from_queryset-return-type" title="Permalink to this headline">¶</a></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticListModel.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">{}</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticListModel.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">{}</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="tortoise.contrib.pydantic.base.PydanticListModel.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">{</span><span class="s1">&#39;root&#39;</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=~</span><span class="n">RootModelRootType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticListModel.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo] objects.</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

</dd></dl>

<dl class="py class objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tortoise.contrib.pydantic.base.</span></span><span class="sig-name descname"><span class="pre">PydanticModel</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><span class="o"><span class="pre">**</span></span><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticModel" title="tortoise.contrib.pydantic.base.PydanticModel.__init__.data (Python parameter)"><span class="n"><span class="pre">data</span></span></a></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/base.html#PydanticModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel" title="Link to this definition">¶</a></dt>
<dd><p>Pydantic BaseModel for Tortoise objects.</p>
<p>This provides an extra method above the usual Pydantic
<a class="reference external" href="https://docs.pydantic.dev/latest/usage/models/#model-properties">model properties</a></p>
<dl class="py method objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset">
<em class="property"><span class="pre">async</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_queryset</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset.queryset" title="tortoise.contrib.pydantic.base.PydanticModel.from_queryset.queryset (Python parameter) — a queryset on the model this PydanticModel is based on."><span class="n"><span class="pre">queryset</span></span></a></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/base.html#PydanticModel.from_queryset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset" title="Link to this definition">¶</a></dt>
<dd><p>Returns a serializable pydantic model instance that contains a list of models,
from the provided queryset.</p>
<p>This will prefetch all the relations automatically.</p>
<dl class="field-list simple">
<dt class="field-odd" id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset-parameters">Parameters<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset-parameters" title="Permalink to this headline">¶</a></dt>
<dd class="field-odd"><dl class="simple api-field highlight">
<dt id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset.queryset"><span class="sig-name descname">queryset</span><span class="p"> : </span><span class="desctype"><span class="desctype"><a class="reference internal" href="../query.html#id3" title="tortoise.queryset.QuerySet (Python class) — Parameterizes a generic class.">QuerySet</a></span></span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset.queryset" title="Permalink to this definition">¶</a></dt><dd><p>a queryset on the model this PydanticModel is based on.</p>
</dd>
</dl>
</dd>
<dt class="field-even" id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset-return-type">Return type<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset-return-type" title="Permalink to this headline">¶</a></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single">
<em class="property"><span class="pre">async</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_queryset_single</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single.queryset" title="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single.queryset (Python parameter) — a queryset on the model this PydanticModel is based on."><span class="n"><span class="pre">queryset</span></span></a></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/base.html#PydanticModel.from_queryset_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single" title="Link to this definition">¶</a></dt>
<dd><p>Returns a serializable pydantic model instance for a single model
from the provided queryset.</p>
<p>This will prefetch all the relations automatically.</p>
<dl class="field-list simple">
<dt class="field-odd" id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single-parameters">Parameters<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single-parameters" title="Permalink to this headline">¶</a></dt>
<dd class="field-odd"><dl class="simple api-field highlight">
<dt id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single.queryset"><span class="sig-name descname">queryset</span><span class="p"> : </span><span class="desctype"><span class="desctype"><a class="reference internal" href="../query.html#id0" title="tortoise.queryset.QuerySetSingle (Python class) — Awaiting on this will resolve a single instance of the Model object, and not a sequence.">QuerySetSingle</a></span></span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single.queryset" title="Permalink to this definition">¶</a></dt><dd><p>a queryset on the model this PydanticModel is based on.</p>
</dd>
</dl>
</dd>
<dt class="field-even" id="tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single-return-type">Return type<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_queryset_single-return-type" title="Permalink to this headline">¶</a></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm">
<em class="property"><span class="pre">async</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tortoise_orm</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm.obj" title="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm.obj (Python parameter) — The Model instance you want serialized."><span class="n"><span class="pre">obj</span></span></a></em></span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tortoise/contrib/pydantic/base.html#PydanticModel.from_tortoise_orm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm" title="Link to this definition">¶</a></dt>
<dd><p>Returns a serializable pydantic model instance built from the provided model instance.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>This will prefetch all the relations automatically. It is probably what you want.</p>
<p>If you don’t want this, or require a <code class="docutils literal notranslate"><span class="pre">sync</span></code> method, look to using <code class="docutils literal notranslate"><span class="pre">.from_orm()</span></code>.</p>
<p>In that case you’d have to manage  prefetching yourself,
or exclude relational fields from being part of the model using
<a class="reference internal" href="#tortoise.contrib.pydantic.creator.PydanticMeta" title="tortoise.contrib.pydantic.creator.PydanticMeta (Python class) — The PydanticMeta class is used to configure metadata for generating the pydantic Model."><code class="xref py py-class docutils literal notranslate"><span class="pre">tortoise.contrib.pydantic.creator.PydanticMeta</span></code></a>, or you would be
getting <code class="docutils literal notranslate"><span class="pre">OperationalError</span></code> exceptions.</p>
<p>This is due to how the <code class="docutils literal notranslate"><span class="pre">asyncio</span></code> framework forces I/O to happen in explicit <code class="docutils literal notranslate"><span class="pre">await</span></code>
statements. Hence we can only do lazy-fetching during an awaited method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd" id="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm-parameters">Parameters<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm-parameters" title="Permalink to this headline">¶</a></dt>
<dd class="field-odd"><dl class="simple api-field highlight">
<dt id="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm.obj"><span class="n sig-name">obj</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm.obj" title="Permalink to this definition">¶</a></dt><dd><p>The Model instance you want serialized.</p>
</dd>
</dl>
</dd>
<dt class="field-even" id="tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm-return-type">Return type<span class="colon">:</span><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.from_tortoise_orm-return-type" title="Permalink to this headline">¶</a></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel.model_computed_fields">
<span class="sig-name descname"><span class="pre">model_computed_fields</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ComputedFieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">{}</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.model_computed_fields" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary of computed field names and their corresponding <cite>ComputedFieldInfo</cite> objects.</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">ConfigDict</span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">{</span><span class="s1">&#39;from_attributes&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.model_config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="tortoise.contrib.pydantic.base.PydanticModel.model_fields">
<span class="sig-name descname"><span class="pre">model_fields</span></span><span class="p"> <span class="pre">:</span> </span><span class="desctype"><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">FieldInfo</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="p"> <span class="pre">=</span> </span><code class="code python docutils literal highlight highlight-python"><span class="p">{}</span></code><a class="headerlink" href="#tortoise.contrib.pydantic.base.PydanticModel.model_fields" title="Link to this definition">¶</a></dt>
<dd><p>Metadata about the fields defined on the model,
mapping of field names to [<cite>FieldInfo</cite>][pydantic.fields.FieldInfo] objects.</p>
<p>This replaces <cite>Model.__fields__</cite> from Pydantic V1.</p>
</dd></dl>

</dd></dl>







                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="linters.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Linters" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Linters
            </div>
          </div>
        </a>
      
      
        
        <a href="unittest.html" class="md-footer__link md-footer__link--next" aria-label="Next: 单元测试支持" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              单元测试支持
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2018 - 2024, Andrey Bondar &amp; Nickolas Grigoriadis &amp; long2ice.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.tabs", "navigation.sections", "navigation.instant", "header.autohide", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "toc.follow", "toc.sticky"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    
  </body>
</html>